<?php echo $this->doctype(); ?>
<html lang="en">
<head>
    <meta charset="utf-8">
    <?php echo $this->headTitle('Express.lk ')->setSeparator(' - ')->setAutoEscape(false) ?>

    <?php
    echo $this->headMeta()
        ->appendName('viewport', 'width=device-width, initial-scale=1.0')
        ->appendHttpEquiv('X-UA-Compatible', 'IE=edge')
    ?>

    <!-- Le styles -->
    <?php
    //echo $this->headLink(array('rel' => 'shortcut icon', 'type' => 'image/vnd.microsoft.icon', 'href' => $this->basePath() . '/img/favicon.ico'))
     //   ->prependStylesheet($this->basePath() . '/min/core.min.css', 'all');
    ?>

<style>
    .mytable { border-collapse: collapse; width:100%; background-color:white; }
    .mytable-head { border:1px solid black;margin-bottom:0;padding-bottom:0; }
    .mytable-head td { border:1px solid black; }
    .mytable-body { border:1px solid black;border-top:0;margin-top:0;padding-top:0;margin-bottom:0;padding-bottom:0; }
    .mytable-body td { border:1px solid black;border-top:0;}
    .mytable-footer { border:1px solid black;border-top:0;margin-top:0;padding-top:0; }
    .mytable-footer td { border:1px solid black;border-top:0;}
	.bold {font-weight: bold;}
	.main-image{ display: block; height: 80px; }
	* {
      font-family: 'Source Sans Pro', sans-serif;
    }
</style>
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
</head>
<body>
<table align="center" width="100%"  >
	<tr>
		<td  ><img style="float: left;" class="main-image" src="/img/logos/sltb-logo.jpg"/></td>
		<td align="center" valign="bottom"> <h4> TICKET BOX USER CASH COLLECTION RECONCILIATION - SHIFT END REPORT</h4> </td>
		<td  ><img style="float: right;" class="main-image" src="/img/express_logo.png"/></td>
	</tr>
</table>
<div class="gap gap-small" ></div>  <br/> 

<div class="container">
<table class="mytable mytable-head">
    <tr>
        <td width="25%">Ticket Box User</td>
        <td width="75%"><?php echo $this->tboxUserName;echo empty($this->tboxUserNIC)? '': '/'.$this->tboxUserNIC;echo  empty($this->tboxUserMobile)? '':  '/'.$this->tboxUserMobile; ?> </td>
    </tr>
     <tr>
        <td width="25%">Generated Range</td>
        <td width="75%" class="bold"><?php echo $this->fromDate.' 00:00'; ?> to <?php echo $this->toDate.' 00:00'; ?> </td>
    </tr>
    <tr>
        <td width="25%">Generated By</td>
        <td width="75%" class="bold"><?php echo $this->tboxUserName ?> on <?php echo date('Y/m/d  G:i:s', time()) ?>  </td>
    </tr>
</table>
<table class="mytable mytable-body">
     <tr>
        <td  width="40%">Total Fare Collected (LKR) </td>
        <td  width="10%" align="right" ><?php echo  number_format($this->totalCollectedServiceCharge,2) ; ?></td>
        <td  width="40%">Total Adult Seats </td>
        <td  width="10%" align="right" ><?php echo   $this->adultSeatCount  ; ?></td>
    </tr>

	<tr>
        <td  width="40%">Service Charge Collected (LKR) </td>
		
        <td  width="10%" align="right" class="bold"><?php echo  number_format($this->totalCollectedFare,2)  ; ?></td>
        <td  width="40%" >Total Child Seats</td>
        <td  width="10%" align="right" ><?php echo  $this->childSeatCount  ; ?></td>
    </tr>
	<tr>
        <td  width="40%" >Total Amount Collected (LKR) </td>
        <td  width="10%" align="right" ><?php echo  number_format($this->totalCollectedFare+$this->totalCollectedServiceCharge,2) ; ?></td>
        <td  width="40%"  >Total Seats  </td>
        <td  width="10%" align="right" ><?php echo  $this->totalSeatCount ; ?></td>
    </tr>
</table>
<table class="mytable mytable-body" height="200">
    <tr>
        <td valign="top" width="100%" height="50%" >Dated Signature of the Ticket Box User</td>
        
    </tr>
    <tr>
        <td valign="top" width="100%">Name / Dated Signature of the Supervisor</td>
        
    </tr>
</table>
 <div class="gap gap-small" ></div>  <br/> 
	<table class="data" align="center"  cellspacing="0" cellpadding="0" width="100%" border="1">
	<tr class="bold">
	  <td align="center" >No.</td>
	  <td align="center" >Operating Route</td>
	  <td align="center">Terminal Out</td>
	  <td align="center">Journey Operator</td>
	  <td align="center">Journey Sectors</td>
	  <td align="center">Fare</td>
	  <td align="center">Fare Type</td>
	  <td align="center">No. of Seats</td>
	  <td align="center">Collected Fare (LKR)</td>
	  <td align="center">Mode of Payment</td>
	  <td align="center">Booking Fee (LKR)</td>
	</tr>
	<?php $leadColumnPrint = true; $idx = 1; foreach($this->collectionData as $row) { ?>
	<?php if(($row->departureTime)&&!($row->sector === NULL)&&!($row->seatFare === NULL)&&!($row->paymentOption === NULL)) { ?>
	<tr>
		<td align="center"><?php echo $idx; ?></td>
	  <?php if($leadColumnPrint) { $leadColumnPrint=false; ?>
		<td align="center"><?php echo $row->routeName; ?></td>
		<td align="center"><?php echo date('Y-m-d h:i',($row->departureTime/1000)); ?></td>
		<td align="center"><?php echo $row->supplier; ?></td>
	  <?php }else { ?>
		<td align="center"> </td>
		<td align="center"> </td>
		<td align="center"> </td>
	  <?php } ?>
	  
	  <td align="center"><?php echo $row->sector; ?></td>
	  <td align="center"><?php echo number_format($row->seatFare,2); ?></td>
	  <td align="center"><?php echo $row->passengerType; ?></td>
	  
	  <td align="center"><?php echo $row->noOfSeats; ?></td>
	  <td align="right"><?php echo number_format($row->collectedFare,2); ?></td>
	  <td align="center"><?php echo  $row->paymentOption ; ?></td>
	  <td align="right"><?php echo number_format($row->bookingFee,2); ?></td>
	</tr>
	<?php $idx +=1; } ?>
	<?php // if(($row->departureTime)&&($row->sector === NULL)&&($row->sector === NULL)) { ?>
	<?php // if(($row->routeName)&&($row->departureTime === NULL) &&($row->supplier === NULL)) { ?>
	<?php  if(($row->seatFare===NULL)&&($row->sector === NULL) &&($row->supplier === NULL)&&!($row->departureTime === NULL)) { ?>
	
	
		<tr>
			<td colspan="7" align="right"><b>Trip Collection for <?php echo $row->plateNumber ?> </b></td>
			<td align="center"><?php echo $row->noOfSeats; ?></td>
			<td align="right"><?php echo number_format($row->collectedFare,2); ?></td>
			<td align="center"></td>
			<td align="right"><?php echo number_format($row->bookingFee,2); ?></td>
		</tr>
	<?php $leadColumnPrint = true; } ?>
	<?php } ?>
	</table>
</div>
<script>
    window.onload = function(){
        window.print();
        window.close();
    };
</script>
</body>
</html>