var expressAdminCrudApp=angular.module("expressAdminCrud",["expressAdmin","ng-admin"]),Entities=Entities?Entities:{};angular.module("expressAdminCrud").config(["NgAdminConfigurationProvider",function(a){try{var b=a,c="/admin-panel/cruds/",d=b.application("Express Admin").baseApiUrl(c);b.parseDate=function(a){return a&&a instanceof Date?a.getTime():a},b.dateFormat="yyyy-MM-dd",b.timeFormat="yyyy-MM-dd HH:mm";var e=b.entity(Entities.Name.accountStatus),f=b.entity(Entities.Name.agent),g=b.entity(Entities.Name.allowedDivisions),h=b.entity(Entities.Name.amenity),i=b.entity(Entities.Name.booking),j=b.entity(Entities.Name.bookingItem),k=b.entity(Entities.Name.bookingItemCharge),l=b.entity(Entities.Name.bookingItemDiscount),m=b.entity(Entities.Name.bookingItemMarkup),n=b.entity(Entities.Name.bookingItemPassenger),o=b.entity(Entities.Name.bookingItemTax),p=b.entity(Entities.Name.bookingStatus),q=b.entity(Entities.Name.bus),r=b.entity(Entities.Name.busImage),s=b.entity(Entities.Name.busBusRoute),t=b.entity(Entities.Name.busRoute),u=b.entity(Entities.Name.busSchedule),v=b.entity(Entities.Name.busScheduleBusStop),w=b.entity(Entities.Name.busStop),x=b.entity(Entities.Name.busType),y=b.entity(Entities.Name.cancellationCharge),z=b.entity(Entities.Name.change),A=b.entity(Entities.Name.changeType),B=b.entity(Entities.Name.city),C=b.entity(Entities.Name.client),D=b.entity(Entities.Name.conductor),E=b.entity(Entities.Name.division),F=b.entity(Entities.Name.driver),G=b.entity(Entities.Name.module),H=b.entity(Entities.Name.operationalSchedule),I=b.entity(Entities.Name.passenger),J=b.entity(Entities.Name.payment),K=b.entity(Entities.Name.permission),L=b.entity(Entities.Name.permissionGroup),M=b.entity(Entities.Name.permissionSingle),N=b.entity(Entities.Name.person),O=b.entity(Entities.Name.refund),P=b.entity(Entities.Name.rule),Q=b.entity(Entities.Name.seatingProfile),R=b.entity(Entities.Name.supplier),S=b.entity(Entities.Name.supplierAccount),T=b.entity(Entities.Name.supplierContactPerson),U=b.entity(Entities.Name.supplierGroup),V=b.entity(Entities.Name.travelClass),W=b.entity(Entities.Name.user),X=b.entity(Entities.Name.userGroup),Y=b.entity(Entities.Name.district);d.addEntity(e).addEntity(f).addEntity(g).addEntity(h).addEntity(i).addEntity(j).addEntity(k).addEntity(l).addEntity(m).addEntity(n).addEntity(o).addEntity(p).addEntity(q).addEntity(r).addEntity(s).addEntity(t).addEntity(u).addEntity(v).addEntity(w).addEntity(x).addEntity(y).addEntity(z).addEntity(A).addEntity(B).addEntity(C).addEntity(D).addEntity(E).addEntity(F).addEntity(Y).addEntity(G).addEntity(H).addEntity(I).addEntity(J).addEntity(K).addEntity(L).addEntity(M).addEntity(N).addEntity(O).addEntity(P).addEntity(R).addEntity(S).addEntity(T).addEntity(U).addEntity(Q).addEntity(V).addEntity(W).addEntity(X),Entities.amenity(b,h).agent(b,f).booking(b,i,C,I,J,O,z,A,j,w,u,p,y,P,W,q,n,f,E).bookingItem(b,j,w,u,m,l,o,k,P,z,A,n,I).bus(b,q,h,t,x,D,F,R,V,r,Q).busImage(b,r,q).busBusRoute(b,s).busSchedule(b,u,q,t,D,F,v,Q,V).client(b,C).conductor(b,D,N).driver(b,F,N).operationalSchedule(b,H,u,t,B,E).payment(b,J,i).person(b,N).refund(b,O,i).supplier(b,R,U,T,S).supplierAccount(b,S,R).supplierContactPerson(b,T,N,R).user(b,W,e,X).userGroup(b,X,K).permissionGroup(b,L,M,G).permissionSingle(b,M,G).city(b,B,Y),d.dashboard(b.dashboard().template($("#admin-dashboard").html())),d.header($("#admin-header").html());var Z=b.menu();Z.template($("#admin-menu").html()),Z.addChild(b.menu().title("Dashboard").icon('<span class="glyphicon glyphicon-dashboard"></span>').link("/dashboard")),ACL.entityCanView(Entities.Name.operationalSchedule,function(){Z.addChild(b.menu(H).title("Operations").icon('<span class="glyphicon glyphicon-console"></span>'))}),ACL.fragmentCanExecute(Fragment.Name.ticketBox,function(){Z.addChild(b.menu().title("Ticket Box").icon('<span class="glyphicon glyphicon-bookmark"></span>').link("/schedule"))});var _=[];if(ACL.entityCanView(Entities.Name.booking)&&_.push(b.menu(i).title("Bookings").icon('<span class="glyphicon glyphicon-equalizer"></span>')),ACL.entityCanDelete(Entities.Name.booking)&&_.push(b.menu().title("Cancellations").icon('<span class="glyphicon glyphicon-remove-sign"></span>').link("/ticket-cancellation")),_.length){for(var aa=b.menu(i).title("Bookings").icon('<span class="glyphicon glyphicon-equalizer"></span>'),ba=0;ba<_.length;ba++)aa.addChild(_[ba]);Z.addChild(aa)}ACL.entityCanView(Entities.Name.bus,function(){Z.addChild(b.menu(q).title("Bus").icon('<span class="glyphicon glyphicon-bed"></span>').addChild(b.menu(q).title("Buses").icon('<span class="glyphicon glyphicon-bed"></span>')).addChild(b.menu().title("Bus Location").icon('<span class="fa fa-location-arrow"></span>').link("/bus-location")))}),ACL.entityCanView(Entities.Name.person,function(){Z.addChild(b.menu().title("People").icon('<span class="glyphicon glyphicon-user"></span>').addChild(b.menu(N).title("People").icon('<span class="glyphicon glyphicon-user"></span>')).addChild(b.menu(D).title("Conductors").icon('<span class="glyphicon glyphicon-user"></span>')).addChild(b.menu(F).title("Drivers").icon('<span class="glyphicon glyphicon-user"></span>')))}),ACL.entityCanView(Entities.Name.agent,function(){Z.addChild(b.menu().title("Common").icon('<span class="glyphicon glyphicon-cog"></span>').addChild(b.menu(f).title("Booking Agents").icon('<span class="fa fa-users"></span>')).addChild(b.menu(h).title("Amenities").icon('<span class="glyphicon glyphicon-headphones"></span>')))}),ACL.entityCanView(Entities.Name.supplier,function(){Z.addChild(b.menu().title("Suppliers").addChild(b.menu(R).title("Suppliers")).addChild(b.menu(S).title("Accounts").icon('<span class="glyphicon glyphicon-usd"></span>')).addChild(b.menu(T).title("Contact Personnel").icon('<span class="glyphicon glyphicon-user"></span>')))});var _=[];if(ACL.entityCanView(Entities.Name.busSchedule)&&_.push(b.menu(u).title("Bus Schedules").icon('<span class="glyphicon glyphicon-calendar"></span>')),ACL.entityCanCreate(Entities.Name.busSchedule)&&_.push(b.menu().title("Create Schedule").icon('<span class="glyphicon glyphicon-plus-sign"></span>').link("/add_schedule")),_.length){for(var aa=b.menu().title("Schedules").icon('<span class="glyphicon glyphicon-calendar"></span>'),ba=0;ba<_.length;ba++)aa.addChild(_[ba]);Z.addChild(aa)}var _=[];if(ACL.entityCanView(Entities.Name.user)&&_.push(b.menu(W).title("Users").icon('<span class="glyphicon glyphicon-user"></span>')),ACL.entityCanView(Entities.Name.userGroup)&&_.push(b.menu(X).title("Roles").icon('<span class="fa fa-users"></span>')),ACL.entityCanView(Entities.Name.permissionSingle)&&_.push(b.menu(M).title("Permissions").icon('<span class="glyphicon glyphicon-tag"></span>')),ACL.entityCanView(Entities.Name.permissionGroup)&&_.push(b.menu(L).title("Permission Groups").icon('<span class="glyphicon glyphicon-tags"></span>')),_.length){for(var aa=b.menu().title("User Administration").icon('<span class="glyphicon glyphicon-tower"></span>'),ba=0;ba<_.length;ba++)aa.addChild(_[ba]);Z.addChild(aa)}var _=[];if(ACL.fragmentCanExecute(Fragment.Name.reportsView)){var aa=b.menu().title("Reports").icon('<span class="glyphicon glyphicon-file"></span>');ACL.fragmentCanExecute(Fragment.Name.expressInvoiceReport)&&aa.addChild(b.menu().title("Express Invoice").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/expInv")),ACL.fragmentCanExecute(Fragment.Name.approvedRefundReport)&&(aa.addChild(b.menu().title("Approved Refunds").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/approvedRefunds")),aa.addChild(b.menu().title("Approved Refunds Updated").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/approvedRefundsV2"))),ACL.fragmentCanExecute(Fragment.Name.futureReservationReport)&&aa.addChild(b.menu().title("Future Reservations").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/futureReservationReport")),ACL.fragmentCanExecute(Fragment.Name.dailyCashReconciliation)&&(aa.addChild(b.menu().title("Daily Cash Reconciliation").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/dailyCashReconciliation")),aa.addChild(b.menu().title("Daily Cash Reconciliation Updated").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/dailyCashReconciliationV2"))),ACL.fragmentCanExecute(Fragment.Name.cashReconciliation)&&aa.addChild(b.menu().title("Cash Reconciliation ").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/cashReconciliation")),ACL.fragmentCanExecute(Fragment.Name.operatedBusFare)&&aa.addChild(b.menu().title("Operated Bus Fare ").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/operatedBusFare")),ACL.fragmentCanExecute(Fragment.Name.operatedBusFee)&&aa.addChild(b.menu().title("Operated Bus Fee").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/operatedBusFee")),ACL.fragmentCanExecute(Fragment.Name.depoOperatedBusFare)&&aa.addChild(b.menu().title("Depot Operated Bus Fare").icon('<span class="glyphicon glyphicon-list-alt"></span>').link("/depotOperatedBusFare")),Z.addChild(aa)}ACL.entityCanView(Entities.Name.city,function(){Z.addChild(b.menu().title("Administration").icon('<span class="glyphicon glyphicon-cog"></span>').addChild(b.menu(B).title("City").icon('<span class="glyphicon glyphicon-map-marker"></span>')))}),d.menu(Z),b.configure(d)}catch(ca){console.log(ca)}}]),angular.module("expressAdminCrud").factory("httpInterceptor",["$q","$injector","notification",function(a,b,c){return{request:function(a){var b=["booking","bus","busSchedule","busRoute","user"],c=!1;for(var d in a.params)a.params.hasOwnProperty(d)&&d.indexOf(".")>-1&&a.params[d]&&(c=!0);for(var e=!1,f=0;f<b.length;f++)if(a.url.match(new RegExp("/"+b[f]+"$","g"))){e=!0;break}return e&&"GET"==a.method&&!c&&(a.url+="Light"),a},response:function(b){return b&&b.data&&b.data.error?(c.log("Error : "+b.data.error,{addnCls:"humane-flatty-error"}),a.reject(b.data)):b},responseError:function(d){return 401===d.status&&(c.log("Your session timed-out",{addnCls:"humane-flatty-error"}),b.get("$state").go("logout")),403===d.status&&(c.log("You are not authorized to access this function ",{addnCls:"humane-flatty-error"}),b.get("$state").go("dashboard")),500===d.status&&c.log("Error : "+d.statusText,{addnCls:"humane-flatty-error"}),a.reject(d)}}}]),angular.module("expressAdminCrud").config(["RestangularProvider","$httpProvider",function(a,b){b.interceptors.push("httpInterceptor"),a.addFullRequestInterceptor(function(a,b,c,d,e,f){if("getList"==b&&(f._page&&(f.pageStart=(f._page-1)*f._perPage,f.pageRows=f._perPage),delete f._page,delete f._perPage,f._sortField&&(f.sortField=f._sortField,delete f._sortField,f._sortDir&&(f.sortDir=f._sortDir,delete f._sortDir)),f._filters)){for(var g in f._filters)f[g]=f._filters[g];delete f._filters}return{params:f}}),a.addResponseInterceptor(function(a,b,c,d,e,f){function g(a){if(a&&a.constructor===Array){var b=[];for(var c in a)a[c].hasOwnProperty("id")&&b.push(a[c].id);return b}return $.isPlainObject(a)&&a.hasOwnProperty("id")?a.id:a}if("getList"===b)for(var h in a)for(var i in a[h])a[h][i]=g(a[h][i]);else if("booking"!==c)for(var h in a)a[h]=g(a[h]);return a})}]),expressAdminCrudApp.controller("bookingController",["$scope","$window",function(a,b){a.addPayment=function(a){},a.addRefund=function(a){},a.cancelBooking=function(a){return!1}}]),expressAdminCrudApp.controller("operationsController",["$scope","$window","scheduleService","reportService","$rootScope","$state","$expConfirm","$uibModal",function(a,b,c,d,e,f,g,h){a.printBookingReport=function(a){var c=960,d=500;return b.open("/admin-panel/me/seatreservationprint?schedule="+a,"Collection Report","status=no,width="+c+",height="+d+",top="+(screen.height/2-d/2)+",left="+(screen.width/2-c/2)+",toolbar=no,menubar=no,scrollbars=no,location=no"),!1},a.viewBookingReport=function(a,b){return i("ScheduleBooking",{SCHEDULE_ID:a},b),!1},a.printPaymentReport=function(a){var c=960,d=500;return b.open("/admin-panel/me/tripcollectionprint?schedule="+a,"Collection Report","status=no,width="+c+",height="+d+",top="+(screen.height/2-d/2)+",left="+(screen.width/2-c/2)+",toolbar=no,menubar=no,scrollbars=no,location=no"),!1},a.viewPaymentReport=function(a,b){return i("BusBookingSummary",{SCHEDULE_ID:a},b),!1},a.changeStageTo=function(b,c){e.Global.loading=!0;var d=h.open({animation:!0,templateUrl:"/admin-panel/bus-service/mockschedulestage?scheduleId="+b+"&stageCode="+c,controller:["$scope","$modalInstance","items",function(b,c,d){e.Global.loading=!1,b.items=d,b.cancel=function(){c.dismiss("cancel")},b.ok=function(){c.dismiss("cancel"),a.commitStageChange(d.scheduleId,d.stageCode)}}],size:"lg",appendTo:"body",resolve:{items:function(){return{scheduleId:b,stageCode:c}}}});d.result.then(function(a){e.Global.loading=!1},function(){})},a.commitStageChange=function(a,b){g({text:'Are you sure you want to change stage to "'+b+'"?',title:"Change the stage?"}).then(function(){e.Global.loading=!0,c.setStage(a,b).then(function(a){e.Global.loading=!1,a.error?(e.Global.error.hasError=!0,e.Global.error.message=a.error):(e.Global.success.isSuccess=!0,e.Global.success.message="Moved to new stage. Wait while list reloads.",f.reload())},function(a){e.Global.loading=!1,e.Global.error.hasError=!0,e.Global.error.message=a})})};var i=function(a,b,c){d.generateReport(a,b)}}]),expressAdminCrudApp.filter("regex",function(){return function(a){var b=/^[A-Z]\d{3}/,c=b.exec(a);return!c}}),Entities.agent=function(a,b){return b.listView().title("Booking agents").fields([a.field("name").label("Name")]).filters([a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50})]),b.editionView().title('Edit booking agent "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Booking agent "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.amenity=function(a,b){return b.listView().title("Amenities").fields([a.field("code").label("Code"),a.field("name").label("Name"),a.field("description").label("Description")]).filters([a.field("code~").label("Code").attributes({placeholder:"Filter by code"}),a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("code").label("Code").validation({required:!0,minlength:2,maxlength:4}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("description","text").label("Description").validation({maxlength:100})]),b.editionView().title('Edit amenity "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Amenity "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.booking=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){return b.listView().title("Bookings").url("bookingLight").fields([a.field("bookingTime","datetime").label("Booking time").format(a.timeFormat).parse(a.parseDate),a.field("reference").label("Reference"),a.field("status").label("Status"),a.field("clientMobileTelephone").label("Mobile"),a.field("fromCity").label("From"),a.field("toCity").label("To")]).filters([a.field("division","reference").targetEntity(s).targetField(a.field("name")).label("Booking division").attributes({placeholder:"Filter by booking division"}),a.field("agent","reference").targetEntity(r).targetField(a.field("name")).label("Agent").attributes({placeholder:"Filter by agent"}),a.field("reference~").label("Reference").pinned(!0).attributes({placeholder:"Filter by reference"}),a.field("clientNic~").label("Client's NIC").pinned(!0).attributes({placeholder:"Filter by client's NIC"}),a.field("clientMobileTelephone").label("Client's mobile").pinned(!0).attributes({placeholder:"Filter by client's mobile"}),a.field("clientName*").label("Client's name").attributes({placeholder:"Filter by client's name"})]).actions(["filter"]).listActions(["show","edit"]),b.editionView().title('Edit booking "{{ entry.values.reference }}"').actions(["list","show"]).fields([a.field("reference").label("Reference").editable(!1),a.field("","template").label("Alerts").template('<alert-sms booking-reference="entry.values.reference"></alert-sms> | <alert-email booking-reference="entry.values.reference"></alert-email>'),a.field("bookingTime","datetime").label("Booking time").format(a.timeFormat).parse(a.parseDate).editable(!1),a.field("status.code").label("Status").editable(!1),a.field("expiryTime","datetime").label("Expiry time").editable(!1).format(a.timeFormat).parse(a.parseDate).cssClasses(function(a){if(a&&a.values&&"CONF"==a.values["status.code"])return"ng-hide"}),a.field("bookingItems","embedded_list").label("Items").targetEntity(i).editable(!1).targetFields([a.field("id").detailLinkRoute("edit").label("ID"),a.field("","template").template("<span>{{entry.values['schedule.bus.plateNumber']}} - {{entry.values['schedule.busRoute.name']}}</span>").label("Bus"),a.field("schedule.departureTime","datetime").format(a.timeFormat).parse(a.parseDate).label("Departure"),a.field("fromBusStop.name").label("From"),a.field("toBusStop.name").label("To"),a.field("","template").template("<span ng-repeat='pass in entry.values.passengers'>{{pass.seatNumber}}{{$last ? '' : ', '}}</span>").label("Seat Numbers")]),a.field("","template").template(" <div class='btn-group'><span class='btn-edit'><a ng-href='#/client/edit/{{entry.values[\"client.id\"]}}' class='btn btn-default'>Edit</a></span><div class='btn btn-default text-selectable'><i class='fa fa-male'></i>    <input type='text' readonly value='{{::entry.values[\"client.nic\"]}}' onclick='this.setSelectionRange(0, this.value.length)' class='submissive' /></div><div class='btn btn-default text-selectable'><i class='fa fa-user'></i>    <input type='text' readonly value='{{::entry.values[\"client.name\"]}}' onclick='this.setSelectionRange(0, this.value.length)' class='submissive' /></div><div class='btn btn-default text-selectable'><i class='fa fa-envelope pink-text'></i>    <input type='text' readonly value='{{::entry.values[\"client.email\"]}}' onclick='this.setSelectionRange(0, this.value.length)' class='submissive' /></div><div class='btn btn-default text-selectable'><i class='fa fa-phone blue-text'></i>    <input type='text' readonly value='{{::entry.values[\"client.mobileTelephone\"]}}' onclick='this.setSelectionRange(0, this.value.length)' class='submissive' /></div></div>").label("Client"),a.field("passengers","embedded_list").label("Passengers").editable(!1).targetEntity(d).targetFields([a.field("name").label("Name"),a.field("nic").label("NIC"),a.field("gender").label("Gender"),a.field("passengerType").label("Type")]),a.field("user.username").label("Booked by").editable(!1),a.field("","template").template("<span>{{entry.values['agent.name']}}</span>").editable(!1).label("Agent"),a.field("chargeable","number").format("0.00").editable(!1).label("Chargeable"),a.field("payments","embedded_list").label("Payments").editable(!1).targetEntity(e).targetFields([a.field("time","datetime").label("Time"),a.field("amount","number").format("0.00").label("Amount"),a.field("mode").label("Mode"),a.field("reference").label("Reference")]),a.field("","template").label("").template('<ma-create-button entity-name="payment" size="sm" label="Add payment" default-values="{ bookingId: entry.values.id }"></ma-create-button>'),a.field("cancellations","embedded_list").label("Cancellation charges").editable(!1).targetEntity(m).targetFields([a.field("cancellationSchemeId","reference").targetEntity(n).targetField(a.field("name")).label("Cancellation scheme"),a.field("amount","number").format("0.00").label("Amount")]),a.field("cancellationCause").editable(!1).cssClasses(function(a){if(a&&a.values&&"CANC"!=a.values["status.code"])return"ng-hide"}).label("Cancellation cause"),a.field("refunds","embedded_list").label("Refunds").editable(!1).targetEntity(f).targetFields([a.field("id").detailLinkRoute("show").label("ID"),a.field("time","datetime").label("Time"),a.field("amount","number").format("0.00").label("Amount"),a.field("mode").label("Mode"),a.field("reference").label("Reference")]),a.field("","template").label("").template('<ma-create-button entity-name="refund" size="sm" label="Add refund" default-values="{ bookingId: entry.values.id }"></ma-create-button>'),a.field("remarks","text").label("Remarks"),a.field("changes","embedded_list").label("Changes").editable(!1).targetEntity(g).targetFields([a.field("changeTime","datetime").label("Time"),a.field("type.code").label("Type"),a.field("description").label("Description")])]),b.showView().title('Booking "{{ entry.values.reference }}"').actions(["list","edit"]).fields([a.field("id").label("ID"),a.field("reference").label("Reference"),a.field("bookingTime","datetime").label("Booking time").format(a.timeFormat).parse(a.parseDate),a.field("status.code").label("Status"),a.field("expiryTime","datetime").label("Expiry time").format(a.timeFormat).parse(a.parseDate).cssClasses(function(a){if(a&&a.values&&"CONF"==a.values["status.code"])return"ng-hide"}),a.field("bookingItems","embedded_list").label("Items").targetEntity(i).targetFields([a.field("","template").template("<span>{{entry.values['schedule.bus.plateNumber']}} - {{entry.values['schedule.busRoute.name']}}</span>").label("Bus"),a.field("","template").template("<span>{{entry.values['schedule.busRoute.name']}}</span>").label("Route"),a.field("schedule.departureTime","datetime").format(a.timeFormat).parse(a.parseDate).label("Departure"),a.field("fromBusStop.name").label("From"),a.field("toBusStop.name").label("To"),a.field("","template").template("<span ng-repeat='pass in entry.values.passengers'>{{pass.seatNumber}}{{$last ? '' : ', '}}</span>").label("Seats")]),a.field("","template").template(" <div class='btn-group'><div class='btn btn-default text-selectable'><i class='fa fa-user'></i> {{entry.values['client.name']}}</div><div class='btn btn-default text-selectable'><i class='fa fa-male'></i> {{entry.values['client.nic']}}</div><div class='btn btn-default text-selectable'><i class='fa fa-phone blue-text'></i> {{entry.values['client.mobileTelephone']}}</div><div class='btn btn-default text-selectable'><i class='fa fa-envelope pink-text'></i> {{entry.values['client.email']}}</div></div>").label("Client"),a.field("passengers","embedded_list").label("Passengers").targetEntity(d).targetFields([a.field("name").label("Name"),a.field("nic").label("NIC"),a.field("gender").label("Gender"),a.field("passengerType").label("Type")]),a.field("user.username").label("Booked by"),a.field("agent.name").label("Agent"),a.field("chargeable","number").format("0.00").label("Chargeable"),a.field("payments","embedded_list").label("Payments").targetEntity(e).targetFields([a.field("id").detailLinkRoute("show").label("ID"),a.field("time","datetime").label("Time"),a.field("amount","number").format("0.00").label("Amount"),a.field("Method").label("Mode").map(function(a,b){return b.mode+" "+b.vendorMode}),a.field("reference").label("Reference")]),a.field("cancellations","embedded_list").label("Cancellation charges").targetEntity(m).targetFields([a.field("cancellationSchemeId","reference").targetEntity(n).targetField(a.field("name")).label("Cancellation scheme"),a.field("amount","number").format("0.00").label("Amount")]),a.field("cancellationCause").cssClasses(function(a){if(a&&a.values&&"CANC"!=a.values["status.code"])return"ng-hide"}).label("Cancellation cause"),a.field("refunds","embedded_list").label("Refunds").targetEntity(f).targetFields([a.field("id").detailLinkRoute("show").label("ID"),a.field("time","datetime").label("Time"),a.field("amount","number").format("0.00").label("Amount"),a.field("mode").label("Mode"),a.field("reference").label("Reference")]),a.field("remarks","text").label("Remarks"),a.field("changes","embedded_list").label("Changes").targetEntity(g).targetFields([a.field("changeTime","datetime").label("Time"),a.field("type.code").label("Type"),a.field("description").label("Description")])]),this},Entities.bookingItem=function(a,b,c,d,e,f,g,h,i,j,k,l,m){return b.editionView().title('<a href="/admin-panel/#/booking/show/{{ entry.values.bookingId }}">Booking #{{ entry.values.bookingId }}</a> / Item #{{ entry.values.index }}').actions(["show"]).fields([a.field("schedule","reference").targetEntity(d).targetField(a.field("id")).detailLinkRoute("show").label("Schedule").editable(!1),a.field("fromBusStop","reference").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}).label("From").validation({required:!0}),a.field("toBusStop","reference").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}).label("To").validation({required:!0}),a.field("passengers","referenced_list").label("Passengers").targetEntity(l).targetReferenceField("bookingItemId").singleApiCall(function(a){return{"id[]":a}}).targetFields([a.field("passengerId","reference").targetEntity(m).targetField(a.field("name")).label("Name"),a.field("seatNumber").label("Seat")]),a.field("fare","number").format("0.00").label("Fare").editable(!1),a.field("markups","referenced_list").label("Markup").singleApiCall(function(a){return{"id[]":a}}).targetEntity(e).targetReferenceField("bookingItemId").targetFields([a.field("markupSchemeId","reference").targetEntity(i).targetField(a.field("name")).label("Markup scheme"),a.field("amount","number").format("0.00").label("Amount")]).permanentFilters({isMargin:!1}),a.field("grossPrice","number").format("0.00").label("Gross price").editable(!1),a.field("discounts","referenced_list").label("Discounts").singleApiCall(function(a){return{"id[]":a}}).targetEntity(f).targetReferenceField("bookingItemId").targetFields([a.field("discountSchemeId","reference").targetEntity(i).targetField(a.field("name")).label("Dicount scheme"),a.field("amount","number").format("0.00").label("Amount")]),a.field("priceBeforeTax","number").format("0.00").label("PBT").editable(!1),a.field("taxes","referenced_list").label("Taxes").singleApiCall(function(a){return{"id[]":a}}).targetEntity(g).targetReferenceField("bookingItemId").targetFields([a.field("taxSchemeId","reference").targetEntity(i).targetField(a.field("name")).label("Tax scheme"),a.field("amount","number").format("0.00").label("Amount")]),a.field("charges","referenced_list").label("Agent charges").singleApiCall(function(a){return{"id[]":a}}).targetEntity(h).targetReferenceField("bookingItemId").targetFields([a.field("chargeSchemeId","reference").targetEntity(i).targetField(a.field("name")).label("Charge scheme"),a.field("amount","number").format("0.00").label("Amount")]),a.field("price","number").format("0.00").label("Price").editable(!1),a.field("remarks","text").label("Remarks"),a.field("changes","referenced_list").label("Changes").singleApiCall(function(a){return{"id[]":a}}).targetEntity(j).targetReferenceField("bookingItemId").targetFields([a.field("changeTime","datetime").label("Time"),a.field("type","reference").targetEntity(k).targetField(a.field("code")).label("Type"),a.field("description").label("Description")])]),b.showView().title('<a href="/admin-panel/#/booking/show/{{ entry.values.bookingId }}">Booking #{{ entry.values.bookingId }}</a> / Item #{{ entry.values.index }}').actions(["edit"]).fields([b.editionView().fields()]),this},Entities.bus=function(a,b,c,d,e,f,g,h,i,j,k){var l=a.entity(Entities.Name.busBusRoute);return b.listView().title("Busses").url("busLight").fields([a.field("plateNumber").label("Plate number"),a.field("name").label("Name")]).filters([a.field("plateNumber*").label("Plate number").pinned(!0).attributes({placeholder:"Filter by plate number"}),a.field("name*").label("Name").attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("plateNumber").label("Plate number").attributes({placeholder:"Eg: NA-0000"}).validation({required:!0,minLength:6,maxlength:50}),a.field("busType","reference").label("Bus type").isDetailLink(!1).validation({required:!0}).targetEntity(e).targetField(a.field("type")).singleApiCall(function(a){return{"id[]":a}}).sortField("type").sortDir("ASC"),a.field("travelClass","reference").label("Travel class").isDetailLink(!1).validation({required:!0}).targetEntity(i).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}).sortField("name").sortDir("ASC"),a.field("supplier","reference").label("Supplier").validation({required:!0}).targetEntity(h).targetField(a.field("name")).sortField("name").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}),a.field("contact").label("Contact number (conductor SMS sent to this)").validation({minLength:9,maxlength:10}),a.field("adminContact").label("Admin contact number (conductor SMS sent to this)").validation({minLength:9,maxlength:10}),a.field("notificationMethod","choice").label("NotificationMethod").validation({required:!0}).choices([{label:"SMS",value:"Sms"},{label:"Call",value:"Call"},{label:"App",value:"App"},{label:"Printout",value:"Printout"}]),a.field("driver","reference").label("Usual driver").validation({required:!0}).targetEntity(g).targetField(a.field("fullName")).detailLinkRoute("show").sortField("fullName").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("conductor","reference").label("Usual conductor").validation({required:!0}).targetEntity(f).targetField(a.field("fullName")).sortField("fullName").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}),a.field("amenities","reference_many").label("Amenities").isDetailLink(!1).targetEntity(c).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("cashOnDepartureAllowed","boolean").label("Allow cash on departure"),a.field("permitNumber").label("Permit number").validation({maxlength:20}),a.field("permitIssueDate","date").label("Permit issue date").format(a.dateFormat).parse(a.parseDate),a.field("permitExpiryDate","date").label("Permit expiry date").format(a.dateFormat).parse(a.parseDate),a.field("seatingProfile","reference").label("Default seating profile").targetEntity(k).targetField(a.field("name")).sortField("name").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("busBusRoute","referenced_list").label("Bus Routes").targetEntity(l).targetReferenceField("busId").targetFields([a.field("busId"),a.field("busRoute","reference").targetEntity(d).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}),a.field("loadFactor"),a.field("","template").label("Actions").template('<ma-edit-button entry="entry" entity-name="busBusRoute" size="xs"></ma-edit-button><ma-delete-button entry="entry" entity-name="busBusRoute" size="xs" ></ma-delete-button>')]).sortField("id").sortDir("DESC").singleApiCall(function(a){return{"id[]":a}}),a.field("","template").label("").template('<ma-create-button entity-name="busBusRoute" size="sm" label="Add Bus Route" default-values="{ busId: entry.values.id }"></ma-create-button>'),a.field("secondsBeforeTicketingActive","number").label("Ticketing activation lead time (in seconds)"),a.field("secondsBeforeTBEnd","number").label("Ticketbox booking close lead time (in seconds)"),a.field("secondsBeforeWebEnd","number").label("Website ticketing close lead time (in seconds)")]),
b.editionView().title('Edit bus "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Bus "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields(),a.field("images","referenced_list").label("Images").targetEntity(j).targetReferenceField("busId").targetFields([a.field("type").label("Type"),a.field("image","template").label("Image").template('<img ng-src="data:image/png;base64,{{entry.values.image}}" style="max-height: 60px;"/>'),a.field("","template").label("Actions").template('<ma-show-button entry="::entry" entity="::entity" size="xs"></ma-show-button><ma-edit-button ng-if="::entity.editionView().enabled" entry="::entry" entity="::entity" size="xs"></ma-edit-button><ma-delete-button ng-if="::entity.deletionView().enabled" entry="::entry" entity="::entity" size="xs"></ma-delete-button>')]),a.field("","template").label("").template('<ma-create-button entity-name="busImage" size="sm" label="Add image" default-values="{ busId: entry.values.id }"></ma-create-button>')]),this},Entities.busBusRoute=function(a,b){var c=a.entity(Entities.Name.bus),d=a.entity(Entities.Name.busRoute);return b.listView().title("Bus Routes").fields([a.field("busRoute")]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().title("Create new BusRoute for a Bus").fields([a.field("busId","reference").label("Bus").validation({required:!0}).targetEntity(c).targetField(a.field("plateNumber")).sortField("plateNumber").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"plateNumber*":a}}}),a.field("busRoute","reference").label("Bus Route").validation({required:!0}).targetEntity(d).targetField(a.field("name")).sortField("name").sortDir("ASC").singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("loadFactor","float").label("Load Factor")]),b.editionView().title("Edit Bus Route for Bus #{{ entry.values.id }}").actions(["show","delete"]).fields([a.field("id").label("ID").editable(!1),b.creationView().fields()]),b.showView().title("Bus Route for Bus #{{ entry.values.id }}").fields([a.field("id").label("ID").editable(!1),b.editionView().fields()]),this},Entities.busImage=function(a,b,c){return b.creationView().title("Create new bus image").fields([a.field("busId","reference").label("Bus").validation({required:!0}).targetEntity(c).targetField(a.field("plateNumber")).sortField("plateNumber").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"plateNumber*":a}}}),a.field("type","choice").label("Type").choices([{label:"Thumbnail",value:"Thumbnail"},{label:"Main",value:"Main"},{label:"Other",value:"Other"}]),a.field("image","file").uploadInformation({url:"/admin-panel/crud_upload/"+b.name(),data:{field_name:"image"}}).label("Image").validation({required:!0})]),b.editionView().title("Edit bus image #{{ entry.values.id }}").actions(["show","delete"]).fields([a.field("busId","reference").label("Bus").targetEntity(c).targetField(a.field("plateNumber")).editable(!1),a.field("type","choice").label("Type").choices([{label:"Thumbnail",value:"Thumbnail"},{label:"Main",value:"Main"},{label:"Other",value:"Other"}]),a.field("image","template").label("Image").template('<img ng-src="data:image/png;base64,{{entry.values.image}}"/>')]),b.showView().title("Bus image #{{ entry.values.id }}").fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.busRoute=function(a,b,c){return b.listView().title("Bus Route").fields([a.field("routeNumber").label("Route Number"),a.field("displayNumber").label("Display Number"),a.field("name").label("Name")]).filters([a.field("name").label("Name").pinned(!0).attributes({placeholder:"Filter by name"}),a.field("routeNumber").label("Route Number").attributes({placeholder:"Filter by Route Number"}),a.field("fromCity","reference").label("From City").targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("toCity","reference").label("To City").targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("routeNumber").label("Route Number"),a.field("displayNumber").label("Display Number"),a.field("name").label("Name"),a.field("fromCity","reference").label("From City").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC"),a.field("toCity","reference").label("To City").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC"),a.field("genderRequired","boolean").label("Gender Required").validation({required:!0}).choices([{value:!0,label:"Enabled"},{value:!1,label:"Disabled"}])]),b.editionView().title('Edit Route "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Route "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.busSchedule=function(a,b,c,d,e,f,g,h,i){return b.listView().title("Bus schedules").url("busScheduleLight").fields([a.field("busRouteName").label("Bus route"),a.field("busPlateNumber").label("Bus"),a.field("departureTime","datetime").label("Departure time").format(a.timeFormat),a.field("arrivalTime","datetime").label("Arrival time").format(a.timeFormat),a.field("","template").label("Reservations").template('<span style="white-space: nowrap;" ng-controller="operationsController"><a href="javascript:;" class="btn btn-default btn-xs" ng-click="printBookingReport(entry.values.id)"><span class="glyphicon glyphicon-print" aria-hidden="true"></span>&nbsp;Print</a></span>')]).filters([a.field("busRoute","reference").label("Bus route").pinned(!0).targetEntity(d).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("bus","reference").label("Bus").pinned(!0).targetEntity(c).targetField(a.field("plateNumber")).sortField("plateNumber").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"plateNumber*":a}}}),a.field("departureOn","date").label("Departure date").pinned(!0).format(a.timeFormat).parse(a.parseDate),a.field("departureStart","datetime").label("Departure time - from").format(a.timeFormat).parse(a.parseDate),a.field("departureEnd","datetime").label("Departure time - to").format(a.timeFormat).parse(a.parseDate),a.field("arrivalStart","datetime").label("Arrival time - from").format(a.timeFormat).parse(a.parseDate),a.field("arrivalEnd","datetime").label("Arrival time - to").format(a.timeFormat).parse(a.parseDate)]).actions('<ma-view-batch-actions buttons="batchButtons()" selection="selection" entity="entity"></ma-view-batch-actions><ma-filter-button filters="filters()" enabled-filters="enabledFilters" enable-filter="enableFilter()" class="ng-scope ng-isolate-scope"></ma-filter-button>').listActions(["show","edit","delete"]),b.editionView().title("Edit bus schedule #{{ entry.values.id }}").actions(["list","show","delete"]).fields([a.field("busRoute","reference").label("Bus route").targetEntity(d).targetField(a.field("name")).isDetailLink(!1).editable(!1).sortField("name").sortDir("ASC"),a.field("departureTime","datetime").label("Departure time").editable(!1),a.field("arrivalTime","datetime").label("Arrival time").editable(!1),a.field("bus","reference").label("Bus").targetEntity(c).targetField(a.field("plateNumber")).remoteComplete(!0,{searchQuery:function(a){return{"plateNumber^":a}}}),a.field("driver","reference").label("Driver").targetEntity(f).targetField(a.field("fullName")).detailLinkRoute("show").validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("conductor","reference").label("Conductor").targetEntity(e).targetField(a.field("fullName")).detailLinkRoute("show").validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("active","boolean").label("Active").validation({required:!0}),a.field("webBookingEndTime","datetime").label("Website booking end time").template('<div class="datetime_widget pull-left"><ma-date-field value="value" field="::field" size="xs"></ma-date-field></div><div class="pull-left btn btn-default ml10">{{entry.values.webBookingEndTime | date:\'yyyy-MM-dd @ h:mma\'}}</div> '),a.field("tbBookingEndTime","datetime").label("TB booking end time").template('<div class="datetime_widget pull-left"><ma-date-field value="value" field="::field" size="xs"></ma-date-field></div><div class="pull-left btn btn-default ml10">{{entry.values.tbBookingEndTime | date:\'yyyy-MM-dd @ h:mma\'}}</div> '),a.field("ticketingActiveTime","datetime").label("App ticketing active time").template('<div class="datetime_widget pull-left"><ma-date-field value="value" field="::field" size="xs"></ma-date-field></div><div class="pull-left btn btn-default ml10">{{entry.values.ticketingActiveTime | date:\'yyyy-MM-dd @ h:mma\'}}</div> '),a.field("seatingProfile","reference").label("Seating profile").targetEntity(h).targetField(a.field("name")).editable(!0).isDetailLink(!1),a.field("loadFactor","float").label("Load Factor"),a.field("stage").label("Operational stage").editable(!1)]),b.showView().title("Bus schedule #{{ entry.values.id }}").fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.busStop=function(a,b,c){return b.listView().title("Stations & Stops").fields([a.field("name").label("Name"),a.field("nameSi").label("Name in Singhala"),a.field("nameTa").label("Name in Tamil"),a.field("city","reference").label("City").targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]).filters([a.field("name").label("Name").pinned(!0).attributes({placeholder:"Filter by name"}),a.field("city","reference").label("City").targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("nameSi").label("Name in Singhala").validation({minLength:1,maxlength:50}),a.field("nameTa").label("Name in Tamil").validation({minLength:1,maxlength:50}),a.field("city","reference").label("City").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").validation({required:!0})]),b.editionView().title('Edit Stops "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Stop "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.city=function(a,b,c){return b.listView().title("Cities").fields([a.field("code").label("Code"),a.field("name").label("Name"),a.field("nameSi").label("Name in Sinhala"),a.field("nameTa").label("Name in Tamil"),a.field("district","reference").label("District").targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("active","choice").label("Status").validation({required:!0}).choices([{label:"Active",value:1},{label:"Inactive",value:0}])]).filters([a.field("code^").label("Code").attributes({placeholder:"Filter by code"}).pinned(!0),a.field("name^").label("Name").pinned(!0).attributes({placeholder:"Filter by name"}),a.field("district~","reference").label("District").targetEntity(c).targetField(a.field("name")).validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("active","choice").label("Status").validation({required:!0}).choices([{label:"Active",value:1},{label:"Inactive",value:0}])]).sortField("name").sortDir("ASC").actions(["filter","create"]).listActions(["edit","delete"]),b.creationView().fields([a.field("code").label("Code").validation({required:!0,minlength:2,maxlength:4}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("nameSi").label("Name in Sinhala").validation({minLength:1,maxlength:50}),a.field("nameTa").label("Name in Tamil").validation({minLength:1,maxlength:50}),a.field("active","boolean").label("Active").defaultValue({eq:!0}).validation({required:!0}).choices([{value:1,label:"Enabled"},{value:0,label:"Disabled"}]),a.field("district","reference").label("District").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").validation({required:!0})]),b.editionView().title('Edit city "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('city "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),b.deletionView().title("Delete city").description('Are you sure you want to delete "{{ entry.values.name }}" ?'),this},Entities.client=function(a,b){var c=a.entity(Entities.Name.user);return b.listView().title("Client").fields([a.field("name").label("Name"),a.field("email").label("Email"),a.field("mobileTelephone").label("Phone")]).actions(["batch","filter"]).listActions(["show","edit"]),b.editionView().title('Edit client "{{ entry.values.name }}"').actions([]).fields([a.field("id").editable(!1).label("ID"),a.field("name").label("Name").validation({required:!0,minlength:1,maxlength:50}),a.field("nic").label("NIC").attributes({placeholder:"Eg: 123456789V"}).validation({minlength:10,maxlength:12}),a.field("email").label("E-mail").validation({required:!1,minlength:3,maxlength:75}),a.field("mobileTelephone").label("Mobile telephone").validation({required:!1,minlength:9,maxlength:10}),a.field("user","reference").label("Linked User").targetEntity(c).targetField(a.field("firstName")).editable(!1)]),b.showView().title('Client "{{ entry.values.name }}"').actions([]).fields([c.editionView().fields()]),this},Entities.conductor=function(a,b,c){return b.listView().title("Conductors").fields([a.field("person.firstName").label("First name"),a.field("person.lastName").label("Last name"),a.field("ntcRegistrationNumber").label("NTC registration"),a.field("person.mobileTelephone").label("Mobile number")]).filters([a.field("ntcRegistrationNumber~").label("NTC registration").attributes({placeholder:"Filter by NTC registration"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("person","reference").label("Person").validation({required:!0}).targetEntity(c).targetField(a.field("fullName")).detailLinkRoute("show").remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("nickName").label("Nickname").validation({minlength:1,maxlength:50}),a.field("ntcRegistrationNumber").label("NTC registration").validation({minlength:3,maxlength:20}),a.field("ntcRegistrationExpiryDate","date").label("NTC registration expiry date").format(a.dateFormat).parse(a.parseDate)]),b.editionView().title('Edit conductor "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Conductor "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.district=function(a,b){return b.listView().title("District").fields([a.field("code").label("Code"),a.field("name").label("Name")]).filters([a.field("code").label("Code").attributes({placeholder:"Filter by code"}).pinned(!0),a.field("name").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("code").label("Code").validation({required:!0,minlength:2,maxlength:4}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50})]),b.editionView().title('Edit District "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('district "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.driver=function(a,b,c){return b.listView().title("Drivers").fields([a.field("person.firstName").label("First name"),a.field("person.lastName").label("Last name"),a.field("ntcRegistrationNumber").label("NTC registration"),a.field("drivingLicence").label("Driving licence"),a.field("person.mobileTelephone").label("Mobile number")]).filters([a.field("ntcRegistrationNumber~").label("NTC registration").attributes({placeholder:"Filter by NTC registration"}),a.field("drivingLicence~").label("Driving licence").attributes({placeholder:"Filter by driving licence"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("person","reference").label("Person").validation({required:!0}).targetEntity(c).targetField(a.field("fullName")).detailLinkRoute("show").remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("nickName").label("Nickname").validation({minlength:1,maxlength:50}),a.field("ntcRegistrationNumber").label("NTC registration").validation({minlength:3,maxlength:20}),a.field("ntcRegistrationExpiryDate","date").label("NTC registration expiry date").format(a.dateFormat).parse(a.parseDate),a.field("drivingLicence").label("Driving licence").validation({minlength:5,maxlength:12}),a.field("drivingLicenceIssueDate","date").label("Driving licence issue date").format(a.dateFormat).parse(a.parseDate),a.field("drivingLicenceExpiryDate","date").label("Driving licence expiry date").format(a.dateFormat).parse(a.parseDate)]),b.editionView().title('Edit driver "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Driver "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.operationalSchedule=function(a,b,c,d,e,f){return b.listView().title("Operations").fields([a.field("routeNumberName").label("Bus route"),a.field("plateNumber").label("Bus"),a.field("arrivalTime","datetime").label("Terminal in").format(a.timeFormat),a.field("departureTime","datetime").cssClasses(function(a){if(a&&a.values&&a.values.departureTime&&moment(a.values.departureTime).startOf("day").isSame(moment().startOf("day")))return"highlight-row"}).label("Terminal out").format(a.timeFormat),a.field("conductorMobile").label("Contact"),a.field("seatReservations","template").label("Reservations").template('<span style="white-space: nowrap;" ng-controller="operationsController"><ma-number-column value="::value"></ma-number-column>&nbsp;<a class="btn btn-default btn-xs" ng-click="printBookingReport(entry.values.id)"><span class="glyphicon glyphicon-print" aria-hidden="true"></span>&nbsp;Print</a></span>'),a.field("totalCost","template").label("Payable").cssClasses("pull-right").template('<span style="white-space: nowrap;" ng-controller="operationsController"><a class="btn btn-default btn-xs" ng-click="printPaymentReport(entry.values.id)"><span class="glyphicon glyphicon-print" aria-hidden="true"></span>&nbsp;Print</a></span>'),a.field("stage","template").label("Stage").template('<span style="white-space: nowrap;" ng-controller="operationsController"><ma-string-column value="::value"></ma-string-column>&nbsp;<a class="btn btn-default btn-xs pink-text" title="Close for bookings" ng-if="entry.values.stage==\'OFB\'" ng-click="changeStageTo(entry.values.id, \'CFB\')"><span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span>&nbsp;Close Bookings (alert)</a><a class="btn btn-default btn-xs" title="Notify the bus" ng-if="entry.values.stage==\'CFB\'" ng-click="changeStageTo(entry.values.id, \'BN\')"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>&nbsp;Bus Notified</a><a class="btn btn-default btn-xs" title="Pay the bus" ng-if="entry.values.stage==\'BN\'" ng-click="changeStageTo(entry.values.id, \'PP\')"><span class="glyphicon glyphicon-usd" aria-hidden="true"></span>&nbsp;Payed</a></span>')]).permanentFilters({arrivalStart:moment().startOf("day").valueOf()}).filters([a.field("divisionId","reference").targetEntity(f).targetField(a.field("name")).label("Booking division"),a.field("fromCityId","reference").label("Departure city").pinned(!0).targetEntity(e).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("routeId","reference").label("Bus route").pinned(!0).targetEntity(d).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("departureStart","datetime").label("Terminal out - from").format(a.timeFormat).pinned(!0).parse(a.parseDate),a.field("departureEnd","datetime").label("Terminal out - to").format(a.timeFormat).pinned(!0).parse(a.parseDate)]).sortField("arrivalTime").sortDir("ASC").actions(["filter"]).listActions(["show"]),b.showView().title("Operational schedule #{{ entry.values.id }}").fields([a.field("routeNumberName").label("Bus route"),a.field("plateNumber").label("Bus"),a.field("arrivalTime","datetime").label("Terminal in").format(a.timeFormat),a.field("departureTime","datetime").label("Terminal out").format(a.timeFormat),a.field("stage").label("Operational Stage"),a.field("conductorName").label("Conductor name"),a.field("conductorMobile").label("Conductor mobile"),a.field("driverName").label("Driver name"),a.field("driverMobile").label("Driver mobile"),a.field("seatReservations","template").label("Reservations").template('<span style="white-space: nowrap;" ng-controller="operationsController"><ma-number-column value="::value"></ma-number-column>&nbsp;<a class="btn btn-default btn-xs" ng-click="viewBookingReport(entry.values.id)"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>&nbsp;Show</a>&nbsp;<a class="btn btn-default btn-xs" ng-click="printBookingReport(entry.values.id)"><span class="glyphicon glyphicon-print" aria-hidden="true"></span>&nbsp;Print</a></span>'),a.field("totalCost","template").label("Payable").template('<span style="white-space: nowrap;" ng-controller="operationsController"><a class="btn btn-default btn-xs" ng-click="viewPaymentReport(entry.values.id)"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>&nbsp;Show</a>&nbsp;<a class="btn btn-default btn-xs" ng-click="printPaymentReport(entry.values.id)"><span class="glyphicon glyphicon-print" aria-hidden="true"></span>&nbsp;Print</a></span>')]).actions(["list"]),this},Entities.payment=function(a,b,c){var d=[];ACL.fragmentCanExecute(Fragment.Name.payMethodCash,function(){d.push({label:"Cash",value:"Cash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodCard,function(){d.push({label:"Card",value:"Card"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodMCash,function(){d.push({label:"mCash",value:"mCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodEzCash,function(){d.push({label:"eZCash",value:"eZCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodBankTransfer,function(){d.push({label:"Bank transfer",value:"BankTransfer"})});var e=[];ACL.fragmentCanExecute(Fragment.Name.payMethodCashBBK,function(){e.push({label:"Cash",value:"Cash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodCardBBK,function(){e.push({label:"Card",value:"Card"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodMCashBBK,function(){e.push({label:"mCash",value:"mCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodEzCashBBK,function(){e.push({label:"eZCash",value:"eZCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodPayPalBBK,function(){e.push({label:"PayPal",value:"PayPal"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodBankTransferBBK,function(){e.push({label:"Bank transfer",value:"BankTransfer"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodVoucherBBK,function(){e.push({label:"Voucher",value:"Voucher"})}),e.push({label:'Vendor (Chose from "Vendor mode")',value:"Vendor"});var f=[{label:"LKR",value:"LKR"}];return ACL.fragmentCanExecute(Fragment.Name.payMethodPayPalBBK,function(){f.push({label:"USD",value:"USD"})}),b.creationView().title("Add new payment").fields([a.field("type","choice").label("Type").validation({required:!0}).defaultValue("Payment").editable(!1).choices([{label:"Payment",value:"Payment"}]),a.field("bookingId").label("Booking Id").editable(!1),a.field("time","datetime").label("Time").editable(!1).defaultValue(new Date).validation({required:!0}),a.field("actualCurrency","choice").label("Currency").validation({required:!0}).choices(f),a.field("actualAmount","float").format("0.00").label("Amount").validation({required:!0}),a.field("amount","float").format("0.00").label("Amount in LKR").validation({required:!0}),a.field("mode","choice").label("Mode").validation({required:!0}).choices(e),a.field("vendorMode","choice").label("Vendor Mode").choices(d),a.field("reference").label("Reference")]),b.editionView().title('Edit payment "{{ entry.values.id }}"').actions(["show"]).fields([b.creationView().fields()]),b.showView().title('Payment "{{ entry.values.id }}"').actions(["edit"]).fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.permissionGroup=function(a,b,c,d){return b.listView().title("Permission groups").fields([a.field("code").label("Code"),a.field("name").label("Name"),a.field("description").label("Description")]).filters([a.field("code~").label("Code").attributes({placeholder:"Filter by code"}),a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().title("Create permission group").fields([a.field("code").label("Code").validation({required:!0,minlength:2,maxlength:100}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("description","text").label("Description").validation({maxlength:100}),a.field("module","reference").label("Module").validation({required:!0}).targetEntity(d).targetField(a.field("name")).permanentFilters({code:"PERMGROUP"}),a.field("permissions","reference_many").label("Permissions").targetEntity(c).targetField(a.field("name")).validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]),b.editionView().title('Edit permission group "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Permission group "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.permissionSingle=function(a,b,c){return b.listView().title("Permissions").fields([a.field("code").label("Code"),a.field("name").label("Name"),a.field("description").label("Description")]).filters([a.field("code~").label("Code").attributes({placeholder:"Filter by code"}),a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().title("Create permission").fields([a.field("code").label("Code").validation({required:!0,minlength:2,maxlength:100}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("description","text").label("Description").validation({maxlength:100}),a.field("module","reference").label("Module").validation({required:!0}).targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]),b.editionView().title('Edit permission "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Permission "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.person=function(a,b){return b.listView().title("People").fields([a.field("firstName").label("First name"),a.field("lastName").label("Last name"),a.field("nic").label("NIC"),a.field("email").label("E-mail")]).filters([a.field("firstName*").label("First name").pinned(!0).attributes({placeholder:"Filter by first name"}),a.field("lastName*").label("Last name").pinned(!0).attributes({placeholder:"Filter by last name"}),a.field("nic~").label("NIC").attributes({placeholder:"Filter by NIC"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("firstName").label("First name").validation({required:!0,minlength:1,maxlength:50}),a.field("middleName").label("Middle name").validation({required:!1,minlength:1,maxlength:50}),a.field("lastName").label("Last name").validation({required:!1,minlength:1,maxlength:50}),a.field("nic").label("NIC").attributes({placeholder:"Eg: 123456789V"}).validation({required:!1,minlength:10,maxlength:12}),a.field("gender","choice").label("Gender").validation({required:!1}).choices([{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Other",value:"Other"}]),a.field("dob","date").label("DoB").format(a.dateFormat).parse(a.parseDate).attributes({placeholder:"Eg: 1975-02-25"}),a.field("email").label("E-mail").validation({required:!1,minlength:3,maxlength:75}),a.field("mobileTelephone").label("Mobile telephone").validation({required:!1,minlength:9,maxlength:10}),a.field("homeTelephone").label("Land telephone").validation({required:!1,minlength:8,maxlength:20}),a.field("workTelephone").label("Work telephone").validation({required:!1,minlength:8,maxlength:20}),a.field("houseNumber").label("House number").validation({required:!1,minlength:1,maxlength:100}),a.field("street").label("Street").validation({required:!1,minlength:1,maxlength:100}),a.field("city").label("City").validation({required:!1,minlength:1,maxlength:30}),a.field("postalCode","number").format("#####").label("Postal code").validation({required:!1,minlength:5,maxlength:5})]),b.editionView().title('Edit person "{{ entry.values.firstName }} {{ entry.values.lastName }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Person "{{ entry.values.firstName }} {{ entry.values.lastName }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.refund=function(a,b,c){var d=[];ACL.fragmentCanExecute(Fragment.Name.payMethodCash,function(){d.push({label:"Cash",value:"Cash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodCard,function(){d.push({label:"Card",value:"Card"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodMCash,function(){d.push({label:"mCash",value:"mCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodEzCash,function(){d.push({label:"eZCash",value:"eZCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodBankTransfer,function(){d.push({label:"Bank transfer",value:"BankTransfer"})});var e=[];ACL.fragmentCanExecute(Fragment.Name.payMethodCashBBK,function(){e.push({label:"Cash",value:"Cash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodCardBBK,function(){e.push({label:"Card",value:"Card"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodMCashBBK,function(){e.push({label:"mCash",value:"mCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodEzCashBBK,function(){e.push({label:"eZCash",value:"eZCash"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodPayPalBBK,function(){e.push({label:"PayPal",value:"PayPal"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodBankTransferBBK,function(){e.push({label:"Bank transfer",value:"BankTransfer"})}),ACL.fragmentCanExecute(Fragment.Name.payMethodVoucherBBK,function(){e.push({label:"Voucher",value:"Voucher"})}),e.push({label:'Vendor (Chose from "Vendor mode")',value:"Vendor"});var f=[{label:"LKR",value:"LKR"}];return ACL.fragmentCanExecute(Fragment.Name.payMethodPayPalBBK,function(){f.push({label:"USD",value:"USD"})}),b.creationView().title("Add new refund").fields([a.field("type","choice").label("Type").validation({required:!0}).defaultValue("Refund").editable(!1).choices([{
label:"Refund",value:"Refund"}]),a.field("bookingId").label("Booking Id").editable(!1),a.field("time","datetime").label("Time").editable(!1).defaultValue(new Date).validation({required:!0}),a.field("actualCurrency","choice").label("Currency").validation({required:!0}).choices(f),a.field("actualAmount","float").format("0.00").label("Amount").validation({required:!0}),a.field("amount","float").format("0.00").label("Amount in LKR").validation({required:!0}),a.field("mode","choice").label("Mode").validation({required:!0}).choices(e),a.field("vendorMode","choice").label("Vendor Mode").choices(d),a.field("reference").label("Reference")]),b.editionView().title('Edit refund "{{ entry.values.id }}"').actions(["show"]).fields([b.creationView().fields()]),b.showView().title('Refund "{{ entry.values.id }}"').actions(["edit"]).fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.supplier=function(a,b,c,d,e){return b.listView().title("Suppliers").fields([a.field("name").label("Name"),a.field("group","reference").targetEntity(c).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}).isDetailLink(!1).label("Supplier group"),a.field("preferredPaymentMode").label("Preferred payment mode")]).filters([a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"}),a.field("group","reference").label("Supplier group").targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC")]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("group","reference").label("Supplier group").isDetailLink(!1).targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC"),a.field("preferredPaymentMode","choice").label("Preferred payment mode").choices([{label:"Cash",value:"Cash"},{label:"mCash",value:"mCash"},{label:"eZCash",value:"eZCash"},{label:"Bank transfer",value:"BankTransfer"},{label:"Cheque",value:"Cheque"}])]),b.editionView().title('Edit supplier "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields(),a.field("contactPersonnel","referenced_list").label("Contact personnel").targetEntity(d).targetReferenceField("supplierId").targetFields([a.field("person.firstName").label("First name"),a.field("person.lastName").label("Last name"),a.field("person.mobileTelephone").label("Mobile telephone")]),a.field("accounts","referenced_list").label("Accounts").targetEntity(e).targetReferenceField("supplierId").targetFields([a.field("name").label("Name"),a.field("bank").label("Bank"),a.field("branch").label("Branch"),a.field("number").label("A/C number")])]),b.showView().title('Supplier "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.supplierAccount=function(a,b,c){return b.listView().title("Accounts").fields([a.field("supplierId","reference").label("Supplier").targetEntity(c).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}),a.field("name").label("Name")]).filters([a.field("supplierId","reference").label("Supplier").pinned(!0).targetEntity(c).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("name*").label("Name").attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("supplierId","reference").label("Supplier").validation({required:!0}).targetEntity(c).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:100}),a.field("number").label("Account number").validation({required:!0,minLength:5,maxlength:20}),a.field("bank").label("Bank").validation({required:!0,minLength:1,maxlength:100}),a.field("branch").label("Branch").validation({required:!0,minLength:1,maxlength:50}),a.field("isPrimary","boolean").label("Primary account").validation({required:!0}),a.field("swift").label("Swift").validation({minLength:1,maxlength:20})]),b.editionView().title('Edit supplier account "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Supplier account "{{ entry.values.name }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.supplierContactPerson=function(a,b,c,d){return b.listView().title("Contact personnel").fields([a.field("supplierId","reference").label("Supplier").targetEntity(d).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}),a.field("person.firstName").label("First name"),a.field("person.lastName").label("Last name"),a.field("person.mobileTelephone").label("Mobile number")]).filters([a.field("supplierId","reference").label("Supplier").pinned(!0).targetEntity(d).targetField(a.field("name")).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().fields([a.field("supplierId","reference").label("Supplier").validation({required:!0}).targetEntity(d).targetField(a.field("name")).sortField("name").sortDir("ASC").remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("person","reference").label("Person").validation({required:!0}).targetEntity(c).targetField(a.field("fullName")).remoteComplete(!0,{searchQuery:function(a){return{"fullName*":a}}}),a.field("owner","boolean").label("Owner").validation({required:!0}),a.field("primary","boolean").label("Primary contact").validation({required:!0})]),b.editionView().title('Edit contact person "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').actions(["list","show","delete"]).fields([b.creationView().fields()]),b.showView().title('Contact person "{{ entry.values.person.firstName }} {{ entry.values.person.lastName }}"').fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.user=function(a,b,c,d){return b.listView().title("User").url("userLight").fields([a.field("username").label("Username"),a.field("firstName").label("First name"),a.field("lastName").label("Last name"),a.field("division").label("Division")]).filters([a.field("firstName*").label("First name").attributes({placeholder:"Filter by first name"}),a.field("lastName*").label("Last name").attributes({placeholder:"Filter by last name"}),a.field("username~").label("Username").attributes({placeholder:"Filter by username"}).pinned(!0)]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().title("Create user").fields([a.field("firstName").label("First name").validation({required:!0,minlength:1,maxlength:50}),a.field("middleName").label("Middle name").validation({required:!1,minlength:1,maxlength:50}),a.field("lastName").label("Last name").validation({required:!1,minlength:1,maxlength:50}),a.field("nic").label("NIC").attributes({placeholder:"Eg: 123456789V"}).validation({minlength:10,maxlength:12}),a.field("gender","choice").label("Gender").validation({required:!1}).choices([{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Other",value:"Other"}]),a.field("dob","date").label("DoB").format(a.dateFormat).parse(a.parseDate).attributes({placeholder:"Eg: 1975-02-25"}),a.field("email").label("E-mail").validation({required:!1,minlength:3,maxlength:75}),a.field("mobileTelephone").label("Mobile telephone").validation({required:!1,minlength:9,maxlength:10}),a.field("homeTelephone").label("Land telephone").validation({required:!1,minlength:8,maxlength:20}),a.field("workTelephone").label("Work telephone").validation({required:!1,minlength:8,maxlength:20}),a.field("houseNumber").label("House number").validation({required:!1,minlength:1,maxlength:100}),a.field("street").label("Street").validation({required:!1,minlength:1,maxlength:100}),a.field("city").label("City").validation({required:!1,minlength:1,maxlength:30}),a.field("postalCode","number").format("#####").label("Postal code").validation({required:!1,minlength:5,maxlength:5}),a.field("status","reference").label("Status").targetEntity(c).targetField(a.field("name")).validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}),a.field("userGroups","reference_many").label("Roles").targetEntity(d).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}).validation({required:!0}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}})]),b.editionView().title('Edit user "{{ entry.values.firstName }} {{ entry.values.lastName }}"').actions(["list","show"]).fields([b.creationView().fields()]),b.showView().title('User "{{ entry.values.firstName }} {{ entry.values.lastName }}"').actions(["list","edit"]).fields([a.field("id").label("ID"),b.editionView().fields()]),this},Entities.userGroup=function(a,b,c){return b.listView().title("Roles").fields([a.field("code").label("Code"),a.field("name").label("Name")]).filters([a.field("code~").label("Code").attributes({placeholder:"Filter by code"}),a.field("name*").label("Name").pinned(!0).attributes({placeholder:"Filter by name"})]).actions(["batch","filter","create"]).listActions(["show","edit","delete"]),b.creationView().title("Create role").fields([a.field("code").label("Code").validation({required:!0,minLength:1,maxlength:50}),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("description","text").label("Description")]),b.editionView().title('Edit role "{{ entry.values.name }}"').actions(["list","show","delete"]).fields([a.field("code").label("Code").editable(!1),a.field("name").label("Name").validation({required:!0,minLength:1,maxlength:50}),a.field("description","text").label("Description"),a.field("permission","reference_many").label("Permissions").targetEntity(c).targetField(a.field("name")).singleApiCall(function(a){return{"id[]":a}}).remoteComplete(!0,{searchQuery:function(a){return{"name*":a}}}).perPage(50)]),b.showView().title('Role "{{ entry.values.name }}"').actions(["list","edit","delete"]).fields([a.field("id").label("ID"),b.editionView().fields()]),this},expressAdminCrudApp.service("reportServiceCrud",["$http","$q",function(a,b){function c(){var b=a.post("/admin-panel/report/getreportlist");return b.then(e,d)}function d(a){return angular.isObject(a.data)&&a.data.error?b.reject(a.data.error):b.reject("An unknown error occurred.")}function e(a){return a.data.hasOwnProperty("error")?b.reject(a.data.error):a.data}return{getReportList:c}}]);